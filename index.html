<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>yyovvo Studio</title>

    <style>
      body {
        margin: 0;
        background: #0d0d0d;
        font-family: "Inter", sans-serif;
        color: white;
      }

      .full-page {
        height: 100vh;
        width: 100vw;
        display: flex;
        flex-direction: column;
        background: linear-gradient(180deg, #0b0b0b, #111);
      }

      .title {
        font-size: 32px;
        font-weight: 700;
        padding: 20px;
        text-align: center;
      }

      .mood-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
        gap: 16px;
        padding: 20px;
      }

      .mood-card {
        background: rgba(255, 255, 255, 0.08);
        border-radius: 16px;
        height: 160px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 18px;
        cursor: pointer;
        transition: 0.2s ease;
      }

      .mood-card:hover {
        background: rgba(255, 255, 255, 0.12);
      }

      .action-button {
        margin: 20px;
        padding: 16px;
        border-radius: 12px;
        font-size: 18px;
        text-align: center;
        background: linear-gradient(135deg, #d517ff, #742bff);
        cursor: pointer;
        transition: 0.2s;
      }
      .action-button:hover {
        opacity: 0.9;
      }

      .message-box {
        padding: 20px;
      }

      textarea {
        width: 100%;
        height: 140px;
        border-radius: 12px;
        padding: 12px;
        border: none;
        outline: none;
        font-size: 16px;
        background: rgba(255,255,255,0.08);
        color: white;
        resize: none;
      }

      .preview-box {
        height: 100vh;
        width: 100vw;
        display: flex;
        flex-direction: column;
        justify-content: space-between;
        background: black;
        padding: 20px;
      }

      .preview-mood {
        flex: 1;
        border-radius: 20px;
        background: rgba(255,255,255,0.08);
        display: flex;
        justify-content: center;
        align-items: center;
        font-size: 26px;
      }

      .bottom-buttons {
        display: flex;
        flex-direction: column;
        gap: 12px;
      }
    </style>
  </head>

  <body>
    <div id="root"></div>

    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>

    <script type="text/javascript">
      const { useState } = React;

      const SAMPLE_MOODS = [
        { id: "mood1", name: "Cosy" },
        { id: "mood2", name: "Hype" },
        { id: "mood3", name: "Snowfall" },
        { id: "mood4", name: "Romantic" },
      ];

      function MoodPage({ selectedMoodId, onSelectMood, onNext }) {
        return React.createElement(
          "div",
          { className: "full-page" },
          React.createElement("div", { className: "title" }, "Pick Your Mood"),
          React.createElement(
            "div",
            { className: "mood-grid" },
            SAMPLE_MOODS.map(function (m) {
              return React.createElement(
                "div",
                {
                  key: m.id,
                  className: "mood-card",
                  style: {
                    border:
                      selectedMoodId === m.id
                        ? "2px solid #d517ff"
                        : "2px solid transparent",
                  },
                  onClick: function () {
                    onSelectMood(m.id);
                  },
                },
                m.name
              );
            })
          ),
          React.createElement(
            "div",
            {
              className: "action-button",
              style: { opacity: selectedMoodId ? 1 : 0.4 },
              onClick: selectedMoodId ? onNext : null,
            },
            "Next ‚Üí"
          )
        );
      }

      function MessagePage({ mood, onBack, onContinue }) {
        const [text, setText] = useState("");

        return React.createElement(
          "div",
          { className: "full-page" },
          React.createElement(
            "div",
            { className: "title" },
            "Add Your Message"
          ),
          React.createElement(
            "div",
            { className: "message-box" },
            React.createElement("textarea", {
              placeholder: "Type your message‚Ä¶",
              value: text,
              onChange: function (e) {
                setText(e.target.value);
              },
            })
          ),
          React.createElement(
            "div",
            { className: "action-button", onClick: function () {
              if (!text.trim())
                return alert("Type a message first!");
              onContinue({ type: "text", text: text });
            }},
            "Preview Your Premier ‚Üí"
          ),
          React.createElement(
            "div",
            {
              className: "action-button",
              style: { background: "#444" },
              onClick: onBack,
            },
            "‚Üê Back"
          )
        );
      }

      function PreviewPage({ mood, message, onBack, onFinish }) {
        return React.createElement(
          "div",
          { className: "preview-box" },
          React.createElement(
            "div",
            { className: "preview-mood" },
            mood.name,
            " ‚Äî ",
            message.text
          ),
          React.createElement(
            "div",
            { className: "bottom-buttons" },
            React.createElement(
              "div",
              { className: "action-button", onClick: onFinish },
              "Render my Premier ‚Üí"
            ),
            React.createElement(
              "div",
              { className: "action-button", style: { background: "#444" }, onClick: onBack },
              "‚Üê Back"
            )
          )
        );
      }

      function App() {
        const [step, setStep] = useState(1);
        const [selectedMoodId, setSelectedMoodId] = useState(null);
        const [messageData, setMessageData] = useState(null);

        // üî• YOUR REAL WORKING API ENDPOINT
        const API_URL =
          "https://moment-cf83ed32.base44.app/api/studio-premier";

        const selectedMood = SAMPLE_MOODS.find(function (m) {
          return m.id === selectedMoodId;
        });

        async function handleRenderPremier() {
          if (!selectedMood || !messageData) {
            alert("Pick a Mood and add a message first.");
            return;
          }

          const payload = {
            mood_id: selectedMood.id,
            mood_url: null,
            message_type: "text",
            message_audio_url: null,
            message_video_url: null,
            message_text: messageData.text,
            duration_s: 16,
            user_agent: navigator.userAgent,
            origin: "studio.yyovvo.com",
          };

          try {
            const res = await fetch(API_URL, {
              method: "POST",
              headers: { "Content-Type": "application/json" },
              body: JSON.stringify(payload),
            });

            const data = await res.json();

            if (!data.ok) throw new Error(data.error);

            alert(
              "Premier saved to yyovvo! üéâ\n\nStudio ID: " +
                data.studio_id +
                "\nStatus: " +
                data.status
            );
          } catch (err) {
            console.error(err);
            alert("Could not save your Premier right now. Try again in a moment.");
          }
        }

        if (step === 3) {
          return React.createElement(PreviewPage, {
            mood: selectedMood,
            message: messageData,
            onBack: function () {
              setStep(2);
            },
            onFinish: handleRenderPremier,
          });
        }

        if (step === 2) {
          return React.createElement(MessagePage, {
            mood: selectedMood,
            onBack: function () {
              setStep(1);
            },
            onContinue: function (msg) {
              setMessageData(msg);
              setStep(3);
            },
          });
        }

        return React.createElement(MoodPage, {
          selectedMoodId: selectedMoodId,
          onSelectMood: setSelectedMoodId,
          onNext: function () {
            if (!selectedMoodId) return;
            setStep(2);
          },
        });
      }

      ReactDOM.createRoot(document.getElementById("root")).render(
        React.createElement(App)
      );
    </script>
  </body>
</html>
